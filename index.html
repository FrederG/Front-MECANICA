<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Login - Plataforma Mec√°nica de Fluidos</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/login.css">
  <style>
    .btn-register {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      background-color: #6c757d;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .btn-register:hover {
      background-color: #5a6268;
    }
  </style>
  
</head>

<body>
  <header>
    <div class="logo-container">
      <img src="https://upload.wikimedia.org/wikipedia/commons/b/b3/Universidad_Tecnol%C3%B3gica_de_Bol%C3%ADvar.png" alt="Logo" class="logo">
      <h1>Acceso a la Plataforma</h1>
    </div>
  </header>

  <main class="login-main">
    <div class="login-card">
      <h2>Iniciar Sesi√≥n üîê</h2>
      <p>Ingresa tus credenciales para acceder a tus ejercicios.</p>

      <form id="loginForm">
        <div class="input-group">
          <label for="usuario">üë§ Usuario</label>
          <input type="text" id="usuario" placeholder="Escribe tu nombre de usuario" required>
        </div>

        <div class="input-group">
          <label for="contrasena">üîë Contrase√±a</label>
          <input type="password" id="contrasena" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
        </div>

        <button type="submit" class="btn-login">Iniciar sesi√≥n</button>
        
        <!-- Bot√≥n para ir al registro -->
        <button type="button" class="btn-register" onclick="window.location.href='HTML/register.html'">
          Crear nueva cuenta
        </button>
      </form>
      <p id="loginMensaje" class="mensaje"></p>
        <script>
          console.log("‚úÖ login cargado correctamente");

const form = document.getElementById("loginForm");
const mensaje = document.getElementById("loginMensaje");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const usuario = document.getElementById("usuario").value.trim();
  const contrasena = document.getElementById("contrasena").value.trim();

  try {
    const response = await fetch("https://backend-fluidos-production.up.railway.app/login/", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ usuario, contrasena }),
    });

    const data = await response.json();

    if (response.ok) {
      mensaje.style.color = "limegreen";
      mensaje.textContent = data.mensaje;

      // ‚úÖ Guardar usuario en localStorage
      localStorage.setItem("usuarioActivo", usuario);

      // Redirigir a ejercicios
      setTimeout(() => {
        window.location.href = "HTML/login.html";
      }, 1000);
    } else {
      mensaje.style.color = "red";
      mensaje.textContent = data.detail || "Error al iniciar sesi√≥n.";
    }

  } catch (error) {
    mensaje.style.color = "red";
    mensaje.textContent = "Error de conexi√≥n con el servidor.";
    console.error("‚ùå Error:", error);
  }
});

document.querySelector(".btn-cerrar-sesion").addEventListener("click", () => {
  localStorage.removeItem("usuarioActivo"); // Borra el usuario guardado
  window.location.href = "login.html";      // Redirige al login
});
        </script>
    </div>
  </main>
</body>
</html>